<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ai Pazar - Dijital Vicdan v27 (Otomatik Model Se√ßici)</title>
    <style>
        :root { --primary: #4285f4; --bg: #121212; --card: #1e1e1e; --text: #e0e0e0; }
        body { font-family: 'Segoe UI', sans-serif; background: var(--bg); color: var(--text); text-align: center; padding: 20px; }
        .container { background: var(--card); display: inline-block; padding: 40px; border-radius: 30px; border: 2px solid var(--primary); max-width: 600px; width: 90%; box-shadow: 0 20px 50px rgba(0,0,0,0.7); margin-top: 30px; }
        h1 { color: var(--primary); margin-bottom: 5px; font-size: 26px; text-transform: uppercase; }
        #status { color: #f1c40f; margin: 15px 0; font-size: 15px; min-height: 24px; font-weight: bold; }
        .mic-btn { background: var(--primary); color: white; width: 80px; height: 80px; border-radius: 50%; font-size: 35px; border: none; cursor: pointer; transition: 0.3s; margin-bottom: 20px; box-shadow: 0 5px 15px rgba(66,133,244,0.3); }
        .mic-btn:active { transform: scale(0.9); background: #ea4335; }
        .input-group { display: flex; gap: 10px; margin-top: 20px; }
        input[type="text"] { flex: 1; padding: 15px; border-radius: 12px; border: 1px solid #333; background: #2b2b2b; color: white; outline: none; }
        .send-btn { background: #34a853; color: white; padding: 0 25px; border-radius: 12px; border: none; font-weight: bold; cursor: pointer; }
        #aiResponse { background: #252525; padding: 25px; border-radius: 20px; margin-top: 30px; text-align: left; line-height: 1.7; min-height: 80px; border-left: 6px solid var(--primary); font-size: 16px; }
        #errorLog { margin-top: 20px; background: #441111; color: #ffbaba; padding: 15px; border-radius: 10px; font-size: 13px; display: none; text-align: left; border: 1px solid #ff4444; }
    </style>
</head>
<body>

<div class="container">
    <h1>sait  Ai Pazar Canlƒ±</h1>
    <p style="font-size: 12px; color: #888;">Dijital Vicdan v27 - √áoklu Model Tarayƒ±cƒ±</p>
    <div id="status">Sistem hazƒ±r, emrinizdeyim...</div>
    
    <button id="startBtn" class="mic-btn">üéôÔ∏è</button>

    <div class="input-group">
        <input type="text" id="userInput" placeholder="Mesajƒ±nƒ±zƒ± buraya yazƒ±n...">
        <button id="sendBtn" class="send-btn">G√ñNDER</button>
    </div>

    <div id="aiResponse">Gemini cevabƒ± burada g√∂r√ºnecek...</div>
    <div id="errorLog"></div>
</div>

<script>
    // API ANAHTARINI BURAYA YAZ
    var API_KEY = "AIzaSyD3HjshxdvUak27pgBsHVEMGGBjhYvGzS4"; 

    var startBtn = document.getElementById('startBtn');
    var sendBtn = document.getElementById('sendBtn');
    var userInput = document.getElementById('userInput');
    var statusText = document.getElementById('status');
    var aiResponse = document.getElementById('aiResponse');
    var errorLog = document.getElementById('errorLog');

    function showLog(msg) {
        errorLog.style.display = "block";
        errorLog.innerHTML += "<div>‚Ä¢ " + msg + "</div>";
    }

    // SES TANIMA
    var SpeechRecognition = window.SpeechRecognition || window.webkitSpeechRecognition;
    if (SpeechRecognition) {
        var recognition = new SpeechRecognition();
        recognition.lang = 'tr-TR';
        startBtn.onclick = function() {
            errorLog.style.display = "none";
            errorLog.innerHTML = "";
            recognition.start();
            statusText.innerText = "Dinliyorum...";
        };
        recognition.onresult = function(event) {
            var text = event.results[0][0].transcript;
            userInput.value = text;
            askGemini(text);
        };
    }

    sendBtn.onclick = function() { if (userInput.value.trim() !== "") askGemini(userInput.value); };

    async function askGemini(soru) {
        statusText.innerText = "Modeller taranƒ±yor, l√ºtfen bekleyin...";
        aiResponse.innerText = "Baƒülantƒ± kuruluyor...";
        errorLog.style.display = "none";
        errorLog.innerHTML = "";

        // DENENECEK YOLLAR VE MODELLER
        var versiyonlar = ["v1beta", "v1"];
        var modeller = ["gemini-1.5-flash", "gemini-1.5-flash-8b", "gemini-pro"];
        
        var basarili = false;

        for (var v of versiyonlar) {
            for (var m of modeller) {
                if (basarili) break;

                var denemeUrl = "https://generativelanguage.googleapis.com/" + v + "/models/" + m + ":generateContent?key=" + API_KEY;
                
                try {
                    console.log("Deneniyor: " + v + " - " + m);
                    var response = await fetch(denemeUrl, {
                        method: 'POST',
                        headers: { 'Content-Type': 'application/json' },
                        body: JSON.stringify({ contents: [{ parts: [{ text: soru }] }] })
                    });

                    var data = await response.json();

                    if (!data.error && data.candidates) {
                        var reply = data.candidates[0].content.parts[0].text;
                        aiResponse.innerText = reply;
                        statusText.innerText = "√áalƒ±≈üan Model Bulundu: " + m + " (" + v + ")";
                        
                        var utter = new SpeechSynthesisUtterance(reply);
                        utter.lang = 'tr-TR';
                        window.speechSynthesis.speak(utter);
                        basarili = true;
                    } else {
                        showLog(v + "/" + m + " ba≈üarƒ±sƒ±z: " + (data.error ? data.error.message : "Yanƒ±t yok"));
                    }
                } catch (err) {
                    showLog(v + "/" + m + " baƒülantƒ± hatasƒ±.");
                }
            }
        }

        if (!basarili) {
            statusText.innerText = "Maalesef kapƒ±lar kapalƒ±.";
            aiResponse.innerText = "Hi√ßbir model anahtarƒ±nƒ±zla e≈üle≈ümedi.";
            showLog("L√ºtfen API anahtarƒ±nƒ±zƒ± ve Google AI Studio izinlerini kontrol edin.");
        }
    }
</script>
</body>
</html>
