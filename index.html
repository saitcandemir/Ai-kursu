<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Güvenli Milli Asistan</title>
    <style>
        :root { --primary: #c0392b; --bg: #ffffff; }
        body { font-family: 'Segoe UI', sans-serif; background: #f4f4f4; margin: 0; display: flex; justify-content: center; align-items: center; height: 100vh; }
        .app-container { width: 95%; max-width: 650px; background: white; border-radius: 20px; box-shadow: 0 20px 40px rgba(0,0,0,0.15); overflow: hidden; display: flex; flex-direction: column; height: 85vh; border-top: 6px solid var(--primary); }
        .header { background: var(--primary); color: white; padding: 15px; text-align: center; font-weight: bold; letter-spacing: 1px; font-size: 1.2rem; }
        #chat-window { flex: 1; padding: 30px; display: flex; flex-direction: column; justify-content: center; background: #fff; text-align: center; overflow-y: auto; }
        .question { font-size: 1rem; color: #7f8c8d; font-style: italic; margin-bottom: 15px; border-bottom: 1px solid #eee; padding-bottom: 10px; }
        .answer { font-size: 1.3rem; color: #2c3e50; font-weight: 500; line-height: 1.6; }
        .input-bar { padding: 20px; display: flex; gap: 10px; border-top: 1px solid #eee; background: #fafafa; }
        input { flex: 1; padding: 15px 25px; border: 2px solid #ddd; border-radius: 35px; outline: none; font-size: 16px; }
        input:focus { border-color: var(--primary); }
        button { background: var(--primary); color: white; border: none; width: 60px; height: 60px; border-radius: 50%; cursor: pointer; display: flex; align-items: center; justify-content: center; transition: 0.3s; }
        button:hover { transform: scale(1.05); background: #a93226; }
        button:disabled { background: #ccc; }
    </style>
</head>
<body>

<div class="app-container">
    <div class="header">MİLLİ ASİSTAN GÜVENLİK SİSTEMİ</div>
    <div id="chat-window">
        <div id="display-area">
            <div class="answer">Değerlerimize ve yasalarımıza bağlı, güvenli asistan sistemi aktif. <br><br> Size nasıl yardımcı olabilirim?</div>
        </div>
    </div>
    <div class="input-bar">
        <input type="text" id="userInput" placeholder="Mesajınızı buraya yazın..." autocomplete="off">
        <button id="sendBtn">
            <svg viewBox="0 0 24 24" width="28" height="28" fill="currentColor"><path d="M2.01 21L23 12 2.01 3 2 10l15 2-15 2z"/></svg>
        </button>
    </div>
</div>

<script type="importmap">
  {
    "imports": { "@google/generative-ai": "https://esm.run/@google/generative-ai@latest" }
  }
</script>

<script type="module">
    import { GoogleGenerativeAI } from "@google/generative-ai";

    const API_KEY = "AIzaSyAh8deBmwgA8dIFpLcAwsJI79CLdz5lKBQ"; 
    const genAI = new GoogleGenerativeAI(API_KEY);

    /* ===========================================================
       ASİSTANIN ANAYASASI VE AHLAK KURALLARI (GÜNCELLENDİ)
       Buradaki maddeler asistanın asla dışına çıkamayacağı kurallardır.
       ===========================================================
    */
    const sistemYonergesi = `
        Senin adın Milli Asistan. Aşağıdaki KESİN kurallara ve kanunlara uymalısın:
        
        1. ASLA CİNSEL İÇERİKLİ konuşmalar yapamazsın. Bu tür talepleri doğrudan reddetmelisin.
        2. SİYASİ tartışmalara giremezsin, herhangi bir siyasi partiyi övemez veya yeremezsin. Tarafsız kalmalısın.
        3. VATAN VE MİLLET SEVGİSİ esastır. Türk halkına, bayrağına, milli ve manevi değerlerine yönelik saldırgan ifadelere asla izin veremezsin.
        4. İSLAM dininin ahlak ve edep kuralları çerçevesinde cevaplar vererek nazik ve terbiyeli olmalısın.
        5. ANAYASAYA ve T.C. kanunlarına aykırı, suça teşvik eden veya toplumu kutuplaştıran hiçbir talebi yerine getiremezsin.
        
        KURAL İHLALİ DURUMUNDA: 
        Eğer kullanıcı bu kuralları zorlarsa, "Değerlerimize ve güvenlik kurallarımıza aykırı talepleri yerine getiremiyorum." şeklinde kısa ve net bir cevap vererek konuyu kapatmalısın.
    `;

    const model = genAI.getGenerativeModel({ 
        model: "gemini-2.5-flash",
        systemInstruction: sistemYonergesi 
    });

    const chatArea = document.getElementById('display-area');
    const userInput = document.getElementById('userInput');
    const sendBtn = document.getElementById('sendBtn');

    function speak(text) {
        window.speechSynthesis.cancel();
        const utterance = new SpeechSynthesisUtterance(text);
        utterance.lang = 'tr-TR';
        window.speechSynthesis.speak(utterance);
    }

    async function handleChat() {
        const prompt = userInput.value.trim();
        if (!prompt) return;

        chatArea.innerHTML = `
            <div class="question">"${prompt}"</div>
            <div class="answer" id="current-answer">İşleniyor...</div>
        `;
        
        userInput.value = '';
        sendBtn.disabled = true;

        try {
            const result = await model.generateContent(prompt);
            const response = await result.response;
            const aiText = response.text();
            
            document.getElementById('current-answer').textContent = aiText;
            speak(aiText);

        } catch (error) {
            document.getElementById('current-answer').innerHTML = `<span style="color:red">Sistem Hatası: ${error.message}</span>`;
        } finally {
            sendBtn.disabled = false;
        }
    }

    sendBtn.addEventListener('click', handleChat);
    userInput.addEventListener('keypress', (e) => { if(e.key === 'Enter') handleChat(); });
</script>

</body>
</html>
